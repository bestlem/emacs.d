#+TITLE:  Imenu
#+AUTHOR: Mark Bestley
#+DATE:   30 Apr 2021
#+PROPERTY:header-args :cache yes :tangle yes :comments noweb
#+STARTUP: overview
* Imenu
:PROPERTIES:
:ID:       org_mark_mini20.local:20210430T161141.960043
:END:
Setup is used in many modes.
#+NAME: org_mark_mini20.local_20220714T180325.278475
#+begin_src emacs-lisp
(use-feature imenu
  :custom
  (imenu-sort-function #'imenu--sort-by-name))
#+end_src

* Add to menubar
:PROPERTIES:
:ID:       org_mark_mini20.local:20210831T062026.341629
:END:
#+NAME: org_mark_mini20.local_20210831T062026.317944
From https://www.emacswiki.org/emacs/ImenuMode
#+NAME: org_mark_mini20.local_20220714T132326.969130
#+begin_src emacs-lisp
(defun imenu-mwb-hook-function ()
  "Add iMenu to menubar"
  (condition-case nil (imenu-add-to-menubar "Imenu") (error nil)))

(add-hook 'font-lock-mode-hook #'imenu-mwb-hook-function)
#+end_src
* Force rescan
:PROPERTIES:
:ID:       org_mark_mini20.local:20210831T062026.340893
:END:
Normal works for elisp and org mode but racket seems to need a rescan. So let's try setting it.
#+NAME: org_mark_mini20.local_20210831T062026.318856
#+begin_src emacs-lisp
(setq imenu-auto-rescan t)
#+end_src

* Which function
:PROPERTIES:
:ID:       org_mark_mini20.local:20211031T140445.090521
:END:
Shows the current function being edited.
Setup for all prog modes
#+NAME: org_mark_mini20.local_20210828T133944.980854
#+begin_src emacs-lisp
(use-feature which-func
  :demand
  :config (which-func-mode))
#+end_src
